"use strict";var __decorate=this&&this.__decorate||function(e,t,r,n){var o,a=arguments.length,c=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(c=(a<3?o(c):a>3?o(t,r,c):o(t,r))||c);return a>3&&c&&Object.defineProperty(t,r,c),c},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),SearchService=function(){function e(){}return e.prototype.extendedTrim=function(e){return e.replace(/\s+/g," ").trim()},e.prototype.perform=function(e,t,r,n){var o=new RegExp("("+t+")","gmi");t=this.extendedTrim(unescape(t));for(var a=[],c=0;c<e.length;c++){for(var i=e[c],f=!1,s=0;s<r.length;s++)if(Array===i[r[s]].constructor){for(var l=i[r[s]],s=0;s<l.length;s++)if(l[s].toLowerCase()===t.toLowerCase()){f=!0;break}if(f)break}else if(i[r[s]].indexOf(t)!==-1||o.test(i[r[s]])){f=!0;break}if(f){var p=Object.assign({},i);n&&(p=this.hightlight(p,o,t)),a.push(p)}}return a.sort(this.compare)},e.prototype.hightlight=function(e,t,r){var n="**$1**";e.title=e.title.replace(t,n),e.content=e.content.replace(t,n);var o=200,a="**"+r+"**",c=e.content.indexOf(a),i=c<o?0:c-o,f=c+a.length,s=f>e.content.length-(o+1)?e.content.length:f+o,l=e.content.substring(i,s),p=l.indexOf(" "),u=l.lastIndexOf(" ");return e.content="..."+l.substring(p,u)+"...",e},e.prototype.compare=function(e,t){return e.date<t.date?1:t.date<e.date?-1:0},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],e)}();exports.SearchService=SearchService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL3NlYXJjaC5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIl9fZGVjb3JhdGUiLCJ0aGlzIiwiZGVjb3JhdG9ycyIsInRhcmdldCIsImtleSIsImRlc2MiLCJkIiwiYyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInIiLCJPYmplY3QiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJSZWZsZWN0IiwiZGVjb3JhdGUiLCJpIiwiZGVmaW5lUHJvcGVydHkiLCJfX21ldGFkYXRhIiwiayIsInYiLCJtZXRhZGF0YSIsImNvcmVfMSIsInJlcXVpcmUiLCJTZWFyY2hTZXJ2aWNlIiwicHJvdG90eXBlIiwiZXh0ZW5kZWRUcmltIiwicyIsInJlcGxhY2UiLCJ0cmltIiwicGVyZm9ybSIsImRhdGEiLCJuZWVkbGUiLCJmaWVsZHMiLCJoaWdodGxpZ2h0IiwicGF0dGVybiIsIlJlZ0V4cCIsInVuZXNjYXBlIiwicmVzdWx0cyIsImVsZW1lbnQiLCJmb3VuZCIsIkFycmF5IiwiY29uc3RydWN0b3IiLCJ0YWdzIiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwidGVzdCIsInJlc3VsdCIsImFzc2lnbiIsInB1c2giLCJzb3J0IiwiY29tcGFyZSIsInRpdGxlIiwiY29udGVudCIsIm9mZnNldCIsImJvbGROZWVkbGUiLCJib2xkTmVlZGxlSW5kZXgiLCJzdGFydCIsIm5lZWRsZUVuZCIsImVuZCIsInNob3J0Q29udGVudCIsInN1YnN0cmluZyIsImZpcnN0U3BhY2VJbmRleCIsImxhc3RTcGFjZUluZGV4IiwibGFzdEluZGV4T2YiLCJhIiwiYiIsImRhdGUiLCJJbmplY3RhYmxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFDQSxJQUFJQSxZQUFjQyxNQUFRQSxLQUFLRCxZQUFlLFNBQVVFLEVBQVlDLEVBQVFDLEVBQUtDLEdBQzdFLEdBQTJIQyxHQUF2SEMsRUFBSUMsVUFBVUMsT0FBUUMsRUFBSUgsRUFBSSxFQUFJSixFQUFrQixPQUFURSxFQUFnQkEs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YyxFQUFHQyxHQUMzQyxNQUFRRCxHQUFFRSxLQUFPRCxFQUFFQyxLQUFRLEVBQU1ELEVBQUVDLEtBQU9GLEVBQUVFLFFBQWEsR0FFN0QzQyxFQUFnQnZCLFlBQ1pxQixPQUFPOEMsYUFDUGxELFdBQVcseUJBQ1pNLEtBR1A2QyxTQUFRN0MsY0FBZ0JBIiwiZmlsZSI6InNlcnZpY2VzL3NlYXJjaC5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIGNvcmVfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL2NvcmUnKTtcbnZhciBTZWFyY2hTZXJ2aWNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTZWFyY2hTZXJ2aWNlKCkge1xuICAgIH1cbiAgICBTZWFyY2hTZXJ2aWNlLnByb3RvdHlwZS5leHRlbmRlZFRyaW0gPSBmdW5jdGlvbiAocykge1xuICAgICAgICByZXR1cm4gcy5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xuICAgIH07XG4gICAgU2VhcmNoU2VydmljZS5wcm90b3R5cGUucGVyZm9ybSA9IGZ1bmN0aW9uIChkYXRhLCBuZWVkbGUsIGZpZWxkcywgaGlnaHRsaWdodCkge1xuICAgICAgICB2YXIgcGF0dGVybiA9IG5ldyBSZWdFeHAoJygnICsgbmVlZGxlICsgJyknLCAnZ21pJyk7XG4gICAgICAgIG5lZWRsZSA9IHRoaXMuZXh0ZW5kZWRUcmltKHVuZXNjYXBlKG5lZWRsZSkpO1xuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IGRhdGEubGVuZ3RoOyByKyspIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZGF0YVtyXTtcbiAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkgPT09IGVsZW1lbnRbZmllbGRzW2ldXS5jb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFncyA9IGVsZW1lbnRbZmllbGRzW2ldXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnc1tpXS50b0xvd2VyQ2FzZSgpID09PSBuZWVkbGUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmQpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50W2ZpZWxkc1tpXV0uaW5kZXhPZihuZWVkbGUpICE9PSAtMSB8fCBwYXR0ZXJuLnRlc3QoZWxlbWVudFtmaWVsZHNbaV1dKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gT2JqZWN0LmFzc2lnbih7fSwgZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGhpZ2h0bGlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5oaWdodGxpZ2h0KHJlc3VsdCwgcGF0dGVybiwgbmVlZGxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICByZXR1cm4gcmVzdWx0cy5zb3J0KHRoaXMuY29tcGFyZSk7XG4gICAgfTtcbiAgICBTZWFyY2hTZXJ2aWNlLnByb3RvdHlwZS5oaWdodGxpZ2h0ID0gZnVuY3Rpb24gKHJlc3VsdCwgcGF0dGVybiwgbmVlZGxlKSB7XG4gICAgICAgIHZhciByZXBsYWNlID0gXCJcXCpcXCokMVxcKlxcKlwiO1xuICAgICAgICByZXN1bHQudGl0bGUgPSByZXN1bHQudGl0bGUucmVwbGFjZShwYXR0ZXJuLCByZXBsYWNlKTtcbiAgICAgICAgcmVzdWx0LmNvbnRlbnQgPSByZXN1bHQuY29udGVudC5yZXBsYWNlKHBhdHRlcm4sIHJlcGxhY2UpO1xuICAgICAgICB2YXIgb2Zmc2V0ID0gMjAwO1xuICAgICAgICB2YXIgYm9sZE5lZWRsZSA9IFwiKipcIiArIG5lZWRsZSArIFwiKipcIjtcbiAgICAgICAgdmFyIGJvbGROZWVkbGVJbmRleCA9IHJlc3VsdC5jb250ZW50LmluZGV4T2YoYm9sZE5lZWRsZSk7XG4gICAgICAgIHZhciBzdGFydCA9IGJvbGROZWVkbGVJbmRleCA8IG9mZnNldCA/IDAgOiBib2xkTmVlZGxlSW5kZXggLSBvZmZzZXQ7XG4gICAgICAgIHZhciBuZWVkbGVFbmQgPSBib2xkTmVlZGxlSW5kZXggKyBib2xkTmVlZGxlLmxlbmd0aDtcbiAgICAgICAgdmFyIGVuZCA9IG5lZWRsZUVuZCA+IHJlc3VsdC5jb250ZW50Lmxlbmd0aCAtIChvZmZzZXQgKyAxKSA/IHJlc3VsdC5jb250ZW50Lmxlbmd0aCA6IChuZWVkbGVFbmQgKyBvZmZzZXQpO1xuICAgICAgICB2YXIgc2hvcnRDb250ZW50ID0gcmVzdWx0LmNvbnRlbnQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xuICAgICAgICB2YXIgZmlyc3RTcGFjZUluZGV4ID0gc2hvcnRDb250ZW50LmluZGV4T2YoXCIgXCIpO1xuICAgICAgICB2YXIgbGFzdFNwYWNlSW5kZXggPSBzaG9ydENvbnRlbnQubGFzdEluZGV4T2YoXCIgXCIpO1xuICAgICAgICByZXN1bHQuY29udGVudCA9IFwiLi4uXCIgKyBzaG9ydENvbnRlbnQuc3Vic3RyaW5nKGZpcnN0U3BhY2VJbmRleCwgbGFzdFNwYWNlSW5kZXgpICsgXCIuLi5cIjtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFNlYXJjaFNlcnZpY2UucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gKGEuZGF0ZSA8IGIuZGF0ZSkgPyAxIDogKChiLmRhdGUgPCBhLmRhdGUpID8gLTEgOiAwKTtcbiAgICB9O1xuICAgIFNlYXJjaFNlcnZpY2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgY29yZV8xLkluamVjdGFibGUoKSwgXG4gICAgICAgIF9fbWV0YWRhdGEoJ2Rlc2lnbjpwYXJhbXR5cGVzJywgW10pXG4gICAgXSwgU2VhcmNoU2VydmljZSk7XG4gICAgcmV0dXJuIFNlYXJjaFNlcnZpY2U7XG59KCkpO1xuZXhwb3J0cy5TZWFyY2hTZXJ2aWNlID0gU2VhcmNoU2VydmljZTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
